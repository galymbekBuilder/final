<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
<title>Цифровые документы</title>
<style>
  :root{
    --vp-w:393px;
    --vp-h:852px;

    --text:#111111;
    --tile:#F2F2F7;
    --bg:#FFFFFF;
    --primary:#145CD8;
    --outline-blue:#7EB0FF;
  }

  html, body{
    margin:0; padding:0; height:100%;
    overflow:hidden;
    background:#ffffff;
    font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","Helvetica Neue",Helvetica,Arial,sans-serif;
    -webkit-font-smoothing:antialiased;
    -webkit-text-size-adjust:100%;
  }

  .stage{ position:fixed; inset:0; display:flex; align-items:flex-start; justify-content:center; }
  .phone{
    width:var(--vp-w);
    height:var(--vp-h);
    background:var(--bg);
    overflow:hidden;
    transform-origin:top center;
  }

  .page{ position:absolute; inset:0; display:none; background:#fff; }
  .page.active{ display:flex; flex-direction:column; overflow:hidden; }

  /* ↓ чуть укоротил верх (просил "поднять") */
  .topbar{ position:relative; height:82px; padding-top:10px; flex-shrink:0; }
  .back{ position:absolute; left:16px; top:38px; width:28px; height:28px; display:flex; align-items:center; justify-content:center; }
  .title{
    position:absolute; top:38px; left:50%; transform:translateX(-50%);
    font-weight:700; font-size:20px; line-height:28px; color:var(--text); white-space:nowrap;
  }

  .content{ padding:0 24px; display:flex; flex-direction:column; height:calc(100% - 82px); }
  .section-title{ margin:24px 0 14px; font-weight:700; font-size:20px; line-height:26px; color:var(--text); }
  .cell{ height:56px; display:flex; align-items:center; position:relative; }
  .icon-wrap{ width:36px; height:36px; border-radius:18px; background:var(--tile); display:flex; align-items:center; justify-content:center; margin-right:12px; }
  .cell-title{ font-weight:600; font-size:16px; color:#1C1C1E; }
  .cell .chev{ position:absolute; right:0; width:22px; height:22px; }
  .refresh{ margin-top:22px; width:100%; height:40px; border:1px solid #007AFF; border-radius:8px; background:#fff; color:#007AFF; font-weight:600; font-size:13.5px; line-height:40px; text-align:center; }

  .tabs-wrap{ padding:0 24px; margin-top:6px; flex-shrink:0; }
  .tabs{ height:34px; background:#ECEAEC; border-radius:10px; display:flex; align-items:center; padding:0 4px; }
  .tab{ flex:1; height:28px; border-radius:8px; display:flex; align-items:center; justify-content:center; font-weight:600; font-size:14px; color:#3A3A3C; border:none; background:transparent; }
  .tab.active{ background:#fff; box-shadow:0 0 0 1px #E8E8EA inset; color:#000; }

  .doc-fill{ flex:1; display:flex; flex-direction:column; overflow:hidden; }

  .doc-photo-area{ position:relative; flex:1; overflow:hidden; background:#fff; }
  .doc-photo-area img{
    position:absolute; inset:0; width:100%; height:100%; object-fit:contain;
    display:none;
    /* после загрузки включим pointer-events, чтобы можно было открыть просмотр */
    pointer-events:none;
  }
  .doc-photo-input{ position:absolute; inset:0; width:100%; height:100%; opacity:0; border:0; margin:0; padding:0; cursor:pointer; }

  .doc-buttons{ margin-top:auto; padding:0 20px 28px; }
  .primary-btn{ height:56px; border-radius:16px; background:var(--primary); color:#fff; display:flex; align-items:center; justify-content:center; gap:10px; font-weight:600; font-size:15px; }
  .outline-btn{ margin-top:14px; height:56px; border-radius:16px; border:2px solid var(--outline-blue); color:var(--primary); background:#fff; display:flex; align-items:center; justify-content:center; gap:10px; font-weight:600; font-size:15px; }

  .req-body{ padding:18px 24px 0; flex:1; overflow:hidden; }
  .req-item{ margin-top:18px; }
  .req-caption{ font-size:12.5px; color:#A3A3A3; font-weight:700; letter-spacing:.2px; margin-bottom:6px; }
  /* ↓ пункты 2: сделали данные менее жирными */
  .req-value{ font-size:15px; color:#2A2A2C; font-weight:600; }

  .send-req{ margin-top:auto; padding:0 20px 28px; }

  /* Просмотрщик (оверлей) для увеличения фото */
  .viewer{ position:fixed; inset:0; background:rgba(0,0,0,0.95); display:none; align-items:center; justify-content:center; z-index:9999; }
  .viewer.show{ display:flex; }
  .viewer img{
    max-width:100%; max-height:100%;
    transform: translate(var(--tx,0px), var(--ty,0px)) scale(var(--scale,1));
    touch-action:none; /* для кастомного pinch/pan */
  }

  *{ -webkit-tap-highlight-color:transparent; }
</style>
</head>
<body>
  <div class="stage">
    <div class="phone" id="phone">

      <!-- Главная -->
      <section id="home" class="page active" aria-label="Главная">
        <div class="topbar">
          <div class="back" aria-hidden="true">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M15.5 4.5L8 12l7.5 7.5" stroke="#000" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>
          <div class="title">Цифровые документы</div>
        </div>

        <div class="content">
          <div class="section-title">Мои документы</div>

          <div class="cell" id="open-id">
            <div class="icon-wrap" aria-hidden="true">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <rect x="3.5" y="6" width="17" height="12" rx="2" stroke="#8E8E93" stroke-width="1.6"/>
                <rect x="6.5" y="9" width="7" height="2.2" rx="1" fill="#8E8E93"/>
                <rect x="6.5" y="12.5" width="10.5" height="1.8" rx="0.9" fill="#8E8E93"/>
              </svg>
            </div>
            <div class="cell-title">Удостоверение личности</div>
            <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M9 4.5L16.5 12 9 19.5" stroke="#B0B0B5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>

          <button class="refresh" type="button">Обновить список документов</button>
        </div>
      </section>

      <!-- УДОСТОВЕРЕНИЕ — ДОКУМЕНТ -->
      <section id="id-doc" class="page" aria-label="Документ">
        <div class="topbar">
          <div class="back" data-goto="home"><svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M15.5 4.5L8 12l7.5 7.5" stroke="#000" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
          <div class="title">Удостоверение личности</div>
        </div>

        <div class="tabs-wrap">
          <div class="tabs" role="tablist">
            <div class="tab active" aria-selected="true">Документ</div>
            <button class="tab" id="goto-req" type="button" aria-selected="false">Реквизиты</button>
          </div>
        </div>

        <div class="doc-fill">
          <div class="doc-photo-area" id="docPhotoArea" aria-label="Фото документа">
            <input class="doc-photo-input" id="docFile" type="file" accept="image/*" aria-hidden="true">
            <img id="docImg" alt="Загруженный документ">
          </div>

          <div class="doc-buttons">
            <div class="primary-btn">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <rect x="3" y="3" width="6" height="6" rx="1.2" stroke="#fff" stroke-width="2"/>
                <rect x="15" y="3" width="6" height="6" rx="1.2" stroke="#fff" stroke-width="2"/>
                <rect x="3" y="15" width="6" height="6" rx="1.2" stroke="#fff" stroke-width="2"/>
                <rect x="15" y="15" width="6" height="6" rx="1.2" stroke="#fff" stroke-width="2"/>
                <rect x="10.5" y="10.5" width="3" height="3" fill="#fff"/>
              </svg>
              Предъявить документ
            </div>

            <div class="outline-btn" id="shareDocBtn">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M12 5.5V16.5" stroke="#1560DC" stroke-width="2" stroke-linecap="round"/>
                <path d="M8.5 8.5L12 5l3.5 3.5" stroke="#1560DC" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <rect x="4" y="12" width="16" height="8" rx="2.5" stroke="#1560DC" stroke-width="2"/>
              </svg>
              Отправить документ
            </div>
          </div>
        </div>
      </section>

      <!-- УДОСТОВЕРЕНИЕ — РЕКВИЗИТЫ -->
      <section id="id-req" class="page" aria-label="Реквизиты">
        <div class="topbar">
          <div class="back" data-goto="home"><svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M15.5 4.5L8 12l7.5 7.5" stroke="#000" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
          <div class="title">Удостоверение личности</div>
        </div>

        <div class="tabs-wrap">
          <div class="tabs" role="tablist">
            <button class="tab" id="goto-doc" type="button" aria-selected="false">Документ</button>
            <div class="tab active" aria-selected="true">Реквизиты</div>
          </div>
        </div>

        <div class="req-body">
          <div class="req-item"><div class="req-caption">ФИО</div><div class="req-value">Аманжан Галымбек Арманулы</div></div>
          <div class="req-item"><div class="req-caption">ИИН</div><div class="req-value">031202550128</div></div>
          <div class="req-item"><div class="req-caption">Дата рождения</div><div class="req-value">02.12.2003</div></div>
          <div class="req-item"><div class="req-caption">Номер документа</div><div class="req-value">060756844</div></div>
          <div class="req-item"><div class="req-caption">Дата выдачи</div><div class="req-value">21.12.2019</div></div>
          <div class="req-item"><div class="req-caption">Срок действия</div><div class="req-value">20.12.2029</div></div>
        </div>

        <div class="send-req">
          <div class="outline-btn">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M12 5.5V16.5" stroke="#1560DC" stroke-width="2" stroke-linecap="round"/>
              <path d="M8.5 8.5L12 5l3.5 3.5" stroke="#1560DC" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <rect x="4" y="12" width="16" height="8" rx="2.5" stroke="#1560DC" stroke-width="2"/>
            </svg>
            Отправить реквизиты
          </div>
        </div>
      </section>

      <!-- Просмотрщик (оверлей) -->
      <div class="viewer" id="viewer">
        <img id="viewerImg" alt="">
      </div>

    </div>
  </div>

<script>
  /* Масштаб как раньше: вписываем и по ширине и по высоте (без скролла) */
  (function fitBoard(){
    const phone = document.getElementById('phone');
    function apply(){
      const vw = Math.min(window.innerWidth, document.documentElement.clientWidth);
      const vh = Math.min(window.innerHeight, document.documentElement.clientHeight);
      const scale = Math.min(vw/393, vh/852);
      phone.style.transform = `scale(${scale})`;
    }
    apply();
    window.addEventListener('resize', apply, {passive:true});
  })();

  /* Роутер */
  const PAGES=['home','id-doc','id-req'];
  function show(id){
    PAGES.forEach(pid=>{
      const el=document.getElementById(pid);
      if(!el) return;
      const on = pid===id;
      el.style.display = on?'flex':'none';
      el.classList.toggle('active', on);
    });
  }
  show('home');

  document.getElementById('open-id').addEventListener('click',()=>show('id-doc'));
  document.querySelectorAll('#id-doc .back, #id-req .back').forEach(b=>b.addEventListener('click',()=>show('home')));
  document.getElementById('goto-req').addEventListener('click',()=>show('id-req'));
  document.getElementById('goto-doc').addEventListener('click',()=>show('id-doc'));

  /* Загрузка фото документа */
  (function initDocUpload(){
    const input = document.getElementById('docFile');
    const img = document.getElementById('docImg');

    input.addEventListener('change', function(){
      const file = this.files && this.files[0];
      if(!file) return;
      const blobUrl = URL.createObjectURL(file);
      img.onload = function(){
        URL.revokeObjectURL(blobUrl);
        input.disabled = true;
        input.style.display = 'none';
        img.style.pointerEvents = 'auto'; // включаем, чтобы открыть просмотр
      };
      img.src = blobUrl;
      img.style.display = 'block';
    });
  })();

  /* Просмотр и зум фото (оверлей, pinch+pan) */
  (function viewer(){
    const triggerImg = document.getElementById('docImg');
    const viewer = document.getElementById('viewer');
    const vImg = document.getElementById('viewerImg');

    function openViewer(){
      if(!triggerImg.src) return;
      vImg.src = triggerImg.src;
      viewer.classList.add('show');
      // сброс трансформаций
      vImg.style.setProperty('--scale', 1);
      vImg.style.setProperty('--tx', '0px');
      vImg.style.setProperty('--ty', '0px');
      state.scale=1; state.tx=0; state.ty=0;
    }
    function closeViewer(){ viewer.classList.remove('show'); }

    triggerImg.addEventListener('click', openViewer);
    viewer.addEventListener('click', (e)=>{ if(e.target===viewer) closeViewer(); });

    // жесты
    const state={scale:1, tx:0, ty:0, startScale:1, startDist:0, lastX:0, lastY:0, panning:false};

    function dist(t){ const dx=t[0].clientX - t[1].clientX; const dy=t[0].clientY - t[1].clientY; return Math.hypot(dx,dy); }

    vImg.addEventListener('touchstart', (e)=>{
      if(e.touches.length===2){
        state.startDist = dist(e.touches);
        state.startScale = state.scale;
      }else if(e.touches.length===1){
        state.panning = true;
        state.lastX = e.touches[0].clientX;
        state.lastY = e.touches[0].clientY;
      }
    }, {passive:false});

    vImg.addEventListener('touchmove', (e)=>{
      if(e.touches.length===2){
        const s = state.startScale * (dist(e.touches)/state.startDist);
        state.scale = Math.max(1, Math.min(4, s));
        vImg.style.setProperty('--scale', state.scale);
      }else if(state.panning && e.touches.length===1 && state.scale>1){
        const x = e.touches[0].clientX;
        const y = e.touches[0].clientY;
        state.tx += (x - state.lastX);
        state.ty += (y - state.lastY);
        state.lastX = x; state.lastY = y;
        vImg.style.setProperty('--tx', state.tx+'px');
        vImg.style.setProperty('--ty', state.ty+'px');
      }
      e.preventDefault();
    }, {passive:false});

    vImg.addEventListener('touchend', ()=>{
      state.panning=false;
    });
  })();

  /* Системное «Поделиться» */
  (function initShare(){
    const btn = document.getElementById('shareDocBtn');
    const img = document.getElementById('docImg');
    async function shareDoc(){
      try{
        if(!navigator.share) return;
        if(img && img.src && img.style.display!=='none'){
          const resp = await fetch(img.src); const blob = await resp.blob();
          const name = (blob.type && blob.type.includes('png'))?'document.png':'document.jpg';
          const file = new File([blob], name, {type:blob.type||'image/jpeg'});
          if(navigator.canShare && navigator.canShare({files:[file]})){
            await navigator.share({files:[file], title:'Документ', text:'Мой документ'});
            return;
          }
        }
        await navigator.share({title:'Документ', text:'Мой документ', url:location.href});
      }catch(e){/* пользователь мог отменить — игнорируем */}
    }
    btn.addEventListener('click', shareDoc);
  })();
</script>
</body>
</html>
